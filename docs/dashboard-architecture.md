# Dashboard Architecture

This document provides a comprehensive overview of the dashboard architecture in Lahat v2.

## Overview

The dashboard component is responsible for instantiating and managing Lahat cells that contain widgets generated by the widget creation component. Dashboards allow widgets to be composed to fulfill the needs of users.

## Architecture

The dashboard architecture follows the three-layer approach described in the WebComponent Architecture document:

1. **WebComponent Layer**: Self-contained, completely unaware of Lahat, focused solely on UI rendering and DOM events
2. **LahatCell Layer**: Manages component lifecycle, handles event communication, acts as a controller, and provides UI integration with Lahat
3. **EventBus Layer**: Handles global event communication (only when needed)

### LahatCell

The LahatCell is a core part of the dashboard component, serving as the container for widgets. It:

1. **Manages WebComponent Lifecycle**: Handles creation, attachment, and destruction of WebComponents
2. **Acts as a Proxy for Events**: Captures events from WebComponents and relays them to the EventBus
3. **Provides UI Integration**: Handles all integration with the Lahat UI
4. **Manages State**: Provides data persistence for WebComponents

### Dashboard Grid

The dashboard grid is responsible for arranging LahatCells in a layout. It:

1. **Manages Layout**: Arranges cells in a grid or other layout
2. **Handles Resizing**: Allows cells to be resized
3. **Handles Dragging**: Allows cells to be moved
4. **Manages Cell Communication**: Facilitates communication between cells

### Dashboard Manager

The Dashboard Manager is responsible for:

1. **Creating Dashboards**: Creates new dashboard objects
2. **Managing Dashboard State**: Saves and restores dashboard configurations
3. **Opening Dashboards**: Creates windows for displaying dashboards
4. **Widget Integration**: Adds and removes widgets from dashboards

## Implementation Details

The dashboard component is implemented using standard web technologies:

1. **WebComponents**: For encapsulation and modularity
2. **CSS Grid**: For flexible layout
3. **EventBus**: For communication between components
4. **LocalStorage**: For persisting dashboard configuration

## Dashboard Persistence

Dashboards are persisted in the Electron store:

```javascript
// Dashboard object structure
{
  id: "uuid",
  name: "Dashboard Name",
  description: "Dashboard description",
  created: "2025-03-21T12:00:00Z",
  isTemporary: false,
  widgets: [
    {
      id: "widget-uuid",
      name: "Widget Name",
      filePath: "/path/to/widget.js",
      position: { x: 0, y: 0 },
      size: { width: 1, height: 1 }
    }
  ],
  layout: {
    columns: 12,
    rows: 8
  }
}
```

## Relationship with Widget Creation

The dashboard component works closely with the widget creation component:

1. **Widget Creation Component**: Generates standalone WebComponents that are independent of Lahat
2. **Dashboard Component**: Instantiates these widgets within Lahat cells and composes them into useful layouts

This separation of concerns allows for:
- Independent development of widgets and dashboards
- Reuse of widgets across multiple dashboards
- Flexible composition of widgets to meet user needs